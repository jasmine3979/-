window.g_config=window.g_config||{},requirejs.config({baseUrl:window.g_config.staticHost!=undefined?"http://"+window.g_config.staticHost+"/static/js/new":"http://static.fuwo.com/static/js/new",paths:{jquery:"lib/jquery"},shim:{}}),require(["jquery","common/base","zxxq/utils/api"],function(e,t,n){var r=3511,i,s,o=function(){t.webapi.location.position(function(e,n,i){e===t.services.CODE_SUCC?(r=i.city_id,r==0&&(r=3511)):t.ui.alert("error",n)})},u=function(n){var r={content:n,style:{marginLeft:"-210px",marginTop:"-200px",height:"400px",width:"420px"}};e("body").append(t.tpls("common/popup/dialog",r)),e(".pop").addClass("home-pop"),t.ui.ieVersion(function(){e(".J-Ie7").show()}),e(".pop-close").click(function(){e(".screen-bg").remove(),e(".pop").remove()})},a=function(i,s){var o=e("#"+i).validate({ignore:"",rules:{username:{required:!0},tel:{required:!0,imobile:!0}},messages:{username:{required:"请填写用户名"},tel:{required:"请填写手机号码",imobile:"请填写正确的手机号码"}},errorPlacement:function(e,t){e.appendTo(t.closest(".input-line"))},submitHandler:function(){var o=e.trim(e("#"+i).find(".J-Name").val()),a=e.trim(e("#"+i).find(".J-Tel").val()),f={name:o,mobile:a,city_id:r,service_type:s};n.infoSave(f,function(n,r,s){e("#"+i).find(".submit").addClass("disabled");if(n===t.services.CODE_SUCC){var o='<div class="pop-success-info"><b>恭喜您已预约成功！</b><br><i class="share-icon-ok"></i><br><span>您已预约成功，我们的装修管家将会尽快与您联系，请保持电话畅通！</span></div>';e(".J-Name").val(""),e(".J-Tel").val(""),e("#"+i).find(".submit").removeClass("disabled"),u(o)}else e("#"+i).find(".submit").removeClass("disabled"),e("#"+i).find(".input-error").html(r)})}})},f=function(n){t.webapi.location.communitySearch(n,function(t,n,r){e(".proposal-box").remove();var i="";for(var s=0;s<r.records.length;s++)i+="<li class='proposal' data-id='"+r.records[s].id+"'><label>"+r.records[s].name+"</label><i> , "+r.records[s].city_name+"</i></li>";e(".J-Houselayout-Search").after("<ul class='proposal-box'>"+i+"</ul>")})};e(function(){t.com.tab.init("J-baoming"),t.ui.lazy(),o(),a("post_baojia",n.ONLINE_NEW_BAOMING),a("post_design",n.ONLINE_NEW_BAOMING),e(".J-Baojia").click(function(){if(e(this).hasClass("btn-disabled"))return;e("#post_baojia").submit()}),e(".J-Design").click(function(){if(e(this).hasClass("btn-disabled"))return;e("#post_design").submit()}),e(".J-Name, .J-Tel").focus(function(){e(".input-error").empty()}),e(".J-Houselayout-Search").bind("keyup",function(t){if(t.which!=13&&t.which!=27&&t.which!=38&&t.which!=40&&t.which!=37&&t.which!=39){var n=e(this),r=e.trim(n.val()),i=e.cookie("city_id");i==null&&(i=3511);if(r==""){e(".proposal-box").remove();return}var s={city_id:i,query:r,start_index:0,count:10};f(s)}}),e(document).delegate(".home-search-input .proposal","click",function(){var t=e.trim(e(this).find("label").html()),n=e(this).data("id");searchUrl=e(".J-Houselayout-Search").attr("data-href"),e(".J-Houselayout-Search").attr("data-id",n),t!=""&&(location.href=searchUrl+n+".html")}),e(".J-Houselayout-Search").keydown(function(t){var n=e.trim(e(".J-Houselayout-Search").val()),r=e.cookie("city_id"),i=e(".proposal"),s=e(".proposal-box").find(".active").find("label").text(),o=e(".proposal-box").find(".active").data("id"),u=e(".J-Houselayout-Search").attr("data-href");r==null&&(r=3511);if(n!=""&&t.which==13)if(e(".proposal-box").find(".active").length>0)location.href=u+e(".J-Houselayout-Search").attr("data-id")+".html";else{if(o==undefined)return;location.href=u+o+".html"}else if(t.which==38)if(i.hasClass("active")){var a=e(".proposal-box").find(".active").index();if(a==0)return;a--,e(".J-Houselayout-Search").val(i.eq(a).find("label").text()),e(".J-Houselayout-Search").attr("data-id",i.eq(a).data("id")),e(".J-Houselayout-Search").focus(),i.removeClass("active"),i.eq(a).addClass("active")}else e(".J-Houselayout-Search").val(i.eq(i.length-1).find("label").text()),e(".J-Houselayout-Search").attr("data-id",i.eq(i.length-1).data("id")),i.eq(i.length-1).addClass("active");else if(t.which==40)if(i.hasClass("active")){var a=e(".proposal-box").find(".active").index();if(a==i.length-1)return;a++,i.removeClass("active"),e(".J-Houselayout-Search").val(i.eq(a).find("label").text()),e(".J-Houselayout-Search").attr("data-id",i.eq(a).data("id")),i.eq(a).addClass("active")}else e(".J-Houselayout-Search").val(i.eq(0).find("label").text()),e(".J-Houselayout-Search").attr("data-id",i.eq(0).data("id")),i.eq(0).addClass("active");else if(t.which==27)e(this).val(""),e(".proposal-box").remove();else if(t.which==32){var l={city_id:r,query:n,start_index:0,count:10};f(l)}}),e(".J-Icon-Dubble").bind({mouseenter:function(){var t=e(this);s=t.find("i").eq(0).attr("class"),t.find("i").eq(0).attr("class",s+"-act"),t.find("i").eq(1).attr("class","newfuwo-icon-more-act position-right")},mouseleave:function(){var t=e(this);t.find("i").eq(0).attr("class",s),t.find("i").eq(1).attr("class","newfuwo-icon-more position-right")}}),t.demand.baomingBottom()})});